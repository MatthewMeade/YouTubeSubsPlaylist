<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="UTF-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <title>Subscriptions Playlist</title>

        <script src="https://apis.google.com/js/api.js"></script>
        <link href="./styles.css" rel="stylesheet" />
    </head>
    <body class="initializing">
        <div class="isSignedIn">
            <div id="loginButton2"></div>
        </div>

        <h1>YouTube Subscriptions Playlist</h1>
        <p>Videos in your subscriptions feed will be added to a playlist</p>
        <a id="playlistUrl" target="_blank">View Your Playlist</a>
        <div class="isSignedOut" id="signInPrompt">
            <div id="loginButton"></div>
            <p>Sign in to get started</p>
        </div>
        <div class="isSignedIn">
            <button id="startButton">Create Playlist</button>

            <p id="statusLog"></p>

            <span id="bookmark">
                <p>
                    To create a bookmark which will update your playlist then automatically start playing, bookmark this
                    url:
                </p>
                <a id="bookmarkURL" target="_blank">Test</a>
            </span>
        </div>

        <script src="main.js"></script>
        <script>
            document.querySelector('#startButton').addEventListener('click', buildPlaylist);
            gapi.load('client:auth2', () => {
                const auth2 = gapi.auth2
                    .init({
                        client_id: '495280427630-v5oe9c0j566drge7e7mk9r5jvacp3bmq.apps.googleusercontent.com'
                    })
                    .then((auth2) => {
                        window.auth2 = auth2;
                        signinChanged();
                    });

                return gapi.client.load('https://www.googleapis.com/discovery/v1/apis/youtube/v3/rest').then(() => {
                    gapi.load('signin2', () => {
                        gapi.signin2.render('loginButton', {
                            theme: 'dark',
                            // onsuccess: () => signinChanged(),
                            scope: 'https://www.googleapis.com/auth/youtube'
                        });

                        gapi.signin2.render('loginButton2', {
                            theme: 'dark',
                            // onsuccess: () => signinChanged(),
                            scope: 'https://www.googleapis.com/auth/youtube'
                        });

                        window.yt = gapi.client.youtube;
                    });
                });
            });
        </script>
    </body>
</html>
